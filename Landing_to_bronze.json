{
    "name": "df_landing_to_bronze_beth",
    "properties": {
        "type": "MappingDataFlow",
        "typeProperties": {
            "sources": [
                {
                    "dataset": {
                        "referenceName": "ds_src_BethLayout",
                        "type": "DatasetReference"
                    },
                    "name": "SrcBeth"
                }
            ],
            "sinks": [
                {
                    "dataset": {
                        "referenceName": "ds_bronze_common",
                        "type": "DatasetReference"
                    },
                    "name": "SnkBhlfrAdjustmentsNew"
                },
                {
                    "dataset": {
                        "referenceName": "ds_bronze_common",
                        "type": "DatasetReference"
                    },
                    "name": "SnkBhlfrCancel"
                },
                {
                    "dataset": {
                        "referenceName": "ds_bronze_common",
                        "type": "DatasetReference"
                    },
                    "name": "SnkBhplatesCancel"
                },
                {
                    "dataset": {
                        "referenceName": "ds_bronze_common",
                        "type": "DatasetReference"
                    },
                    "name": "SnkBhplatesAdjustmentsNew"
                },
                {
                    "dataset": {
                        "referenceName": "ds_bronze_common",
                        "type": "DatasetReference"
                    },
                    "name": "SnkEpAdjustmentsNew"
                },
                {
                    "dataset": {
                        "referenceName": "ds_bronze_common",
                        "type": "DatasetReference"
                    },
                    "name": "SnkEPCancel"
                },
                {
                    "dataset": {
                        "referenceName": "ds_bronze_common",
                        "type": "DatasetReference"
                    },
                    "name": "SnkBhlfrNew"
                },
                {
                    "dataset": {
                        "referenceName": "ds_bronze_common",
                        "type": "DatasetReference"
                    },
                    "name": "SnkBhplatesNew"
                },
                {
                    "dataset": {
                        "referenceName": "ds_bronze_common",
                        "type": "DatasetReference"
                    },
                    "name": "SnkEpNew"
                }
            ],
            "transformations": [
                {
                    "name": "DerivedColn"
                },
                {
                    "name": "FtrValidRec"
                },
                {
                    "name": "splitFiles"
                },
                {
                    "name": "FtrAdjustments"
                },
                {
                    "name": "FtrNonAdjustments"
                },
                {
                    "name": "split1"
                },
                {
                    "name": "select1"
                },
                {
                    "name": "SplitBasedOnBol"
                }
            ],
            "scriptLines": [
                "parameters{",
                "     FileName_BHLFRNew as string,",
                "     FileName_BHLFRCancel as string,",
                "     FileName_BHPlatesNew as string,",
                "     FileName_BHPlatesCancel as string,",
                "     FileName_EasternPlatesNew as string,",
                "     FileName_EasternPlatesCancel as string,",
                "     FileName_BHLFRAdjustmentsNew as string,",
                "     FileName_BHPlatesAdjustmentsNew as string,",
                "     FileName_EasternPlatesAdjustmentsNew as string",
                "}",
                "source(output(",
                "          {_c0} as string,",
                "          ACD as string,",
                "          INVOICE_NUM as string,",
                "          MATERIAL_ID as string,",
                "          INVOICE_CC_INVOICE_YEAR as string,",
                "          INVOICE_MONTH as string,",
                "          INVOICE_DAY as string,",
                "          PACK_BOL_NUM as string,",
                "          PACK_SLIP_NUM as string,",
                "          SHIPPED_CC_SHIPPED_YEAR as string,",
                "          SHIPPED_MONTH as string,",
                "          SHIPPED_DAY as string,",
                "          SHIP_MO as string,",
                "          SHIP_DAY as string,",
                "          SHIP_YEAR as string,",
                "          SHIPPED_TIME as string,",
                "          MS_INTERPLANT as string,",
                "          METH_OF_SHIP as string,",
                "          SCAC_CODE as string,",
                "          SCAC_DESCR as string,",
                "          ROUTE_CODE as string,",
                "          ROUTE_DESCR as string,",
                "          VEHICLE_ID as string,",
                "          P_C_IND as string,",
                "          PREPAID_COLLECT as string,",
                "          MILEAGE as string,",
                "          DISTANCE_UOM as string,",
                "          TOTAL_SHIP_WEIGHT as string,",
                "          UOM_WEIGHT as string,",
                "          MIN_WEIGHT as string,",
                "          MIN_WEIGHT_UOM as string,",
                "          TOTAL_FRT_COST as string,",
                "          FRT_RATE as string,",
                "          FRT_UOM as string,",
                "          ADDTNL_FRT_COST as string,",
                "          ADDTNL_FRT_RATE as string,",
                "          ADDTNL_FRT_UOM as string,",
                "          FRT_COST_SC as string,",
                "          FRT_SC_RATE as string,",
                "          FRT_SC_UOM as string,",
                "          CUST_CODE as string,",
                "          BILL_TO_CUSTOMER as string,",
                "          ORIG_CUST_CODE as string,",
                "          SHIP_FROM_DESCR as string,",
                "          SHIP_FROM_STATE as string,",
                "          SHIP_FROM_CITY as string,",
                "          SHIP_FROM_ZIP_CODE as string,",
                "          SHIP_FROM_COUNTRY as string,",
                "          DEST_CUST_CODE as string,",
                "          SHIP_TO_CUSTOMER as string,",
                "          SHIP_TO_STATE as string,",
                "          SHIP_TO_CITY as string,",
                "          SHIP_TO_ZIP_CODE as string,",
                "          SHIP_TO_COUNTRY as string,",
                "          DATA_SOURCE as string,",
                "          COMPETITIVE_IND as string,",
                "          CONTRACT_RATE as string,",
                "          MILL_ORDER_SPLIT_NO1 as string,",
                "          MS_ORDER_MILL_SPLIT_NO2 as string,",
                "          FACILITY_CODE as string,",
                "          STCC_CODE_OUT as string,",
                "          THICKNESS_MAX as string,",
                "          THICKNESS_UOM as string,",
                "          WIDTH_MAX as string,",
                "          WIDTH_UOM as string,",
                "          LENGTH_MAX as string,",
                "          LENGTH_UOM as string,",
                "          PART_NUMBER as string,",
                "          PART_NUMBER_DESC as string,",
                "          COMMODITY_DESCR as string,",
                "          ITEM_FRT_COST as string,",
                "          MATL_ID_WEIGHT as string,",
                "          MATL_ID_LAST_COIL as string,",
                "          MATL_ID_PRO_AMT as string,",
                "          MATL_ID_SC_AMT as string,",
                "          CUST_FRT as string,",
                "          POSTING_PERIOD as string,",
                "          ITEM_SHIPPED_PIECES as string,",
                "          PROCESSOR_MATL_ID as string,",
                "          OUT_TM_AVAIL_TO_SHIP_DATE as string,",
                "          OUT_TM_LOAD_READY_DATE as string,",
                "          OUT_TM_DATE_SCHD_PICKUP as string,",
                "          OUT_TM_PLN_CARRIER_PICKUP_DTE as string,",
                "          OUT_PLANNED_TRANS_MODE as string,",
                "          OUT_PLANNED_FRT_TYPE_CODE as string,",
                "          OUT_PLANNED_NEXT_SHIP_DATE as string,",
                "          OUT_HEAT_NBR as string,",
                "          ACCT_PROD_CODE as string,",
                "          BETH_SOURCE_CODE as string,",
                "          LINEAL_FT_ENG as string,",
                "          LINEAL_FT_MET as string,",
                "          THEO_WGT_LB as string,",
                "          THEO_WGT_KG as string,",
                "          TIME_ZONE as string,",
                "          SAP_ORDER_NUM as string,",
                "          {_c95} as string",
                "     ),",
                "     allowSchemaDrift: false,",
                "     validateSchema: false,",
                "     ignoreNoFilesFound: false) ~> SrcBeth",
                "FtrValidRec derive(STATUS = iif(toInteger(MATL_ID_WEIGHT) < 0 ,'CANCELED',iif(toInteger(MATL_ID_WEIGHT)> 0,'SHIPPED',toString(null()))),",
                "          ACTION = iif(toInteger(MATL_ID_WEIGHT) < 0 ,'DELETE',iif(toInteger(MATL_ID_WEIGHT)> 0,'ADD',toString(null()))),",
                "          BOL_NUMBER = substring(PACK_BOL_NUM, 1, 10),",
                "          SHIPMENT_DATE = concat(SHIPPED_MONTH,'/',SHIPPED_DAY,'/',SHIPPED_CC_SHIPPED_YEAR),",
                "          SOURCE_TYPE = iif(FACILITY_CODE==\"54\",\"BHLFR\",iif(FACILITY_CODE==\"55\",\"BH-PLATES\",iif((FACILITY_CODE == \"58\" || FACILITY_CODE==\"59\"), \"EASTERN PLATES\",''))),",
                "          MATERIAL_ID = trim(MATERIAL_ID)) ~> DerivedColn",
                "SplitBasedOnBol@ValidBols filter((trim(FACILITY_CODE) == \"54\"  || trim(FACILITY_CODE) ==\"55\" || trim(FACILITY_CODE) ==\"58\" || trim(FACILITY_CODE) ==\"59\") && trim(MATERIAL_ID) !=''\r",
                "&& (! isNull(MATERIAL_ID)) && regexMatch(trim(MATERIAL_ID),'.*[1-9]+')) ~> FtrValidRec",
                "FtrAdjustments split(SOURCE_TYPE ==\"BHLFR\" && STATUS ==\"SHIPPED\",",
                "     SOURCE_TYPE ==\"BHLFR\" && STATUS ==\"CANCELED\",",
                "     SOURCE_TYPE ==\"BH-PLATES\" && STATUS ==\"SHIPPED\",",
                "     SOURCE_TYPE ==\"BH-PLATES\" && STATUS ==\"CANCELED\",",
                "     SOURCE_TYPE ==\"EASTERN PLATES\" && STATUS ==\"SHIPPED\",",
                "     SOURCE_TYPE ==\"EASTERN PLATES\" && STATUS ==\"CANCELED\",",
                "     disjoint: false) ~> splitFiles@(BHlfrAdjustmentsNew, BHlfrCancel, BHPlatesAdjustmentsNew, BHPlatesCancel, EPAdjustmentsNew, EPCancel, Default)",
                "DerivedColn filter(substring(trim(INVOICE_NUM), -5, 3)=='-85' || substring(trim(INVOICE_NUM), -5, 3)=='-88' || substring(trim(INVOICE_NUM), -5, 3)=='-89') ~> FtrAdjustments",
                "DerivedColn filter(substring(trim(INVOICE_NUM), -5, 3)!='-85' && substring(trim(INVOICE_NUM), -5, 3)!='-88' && substring(trim(INVOICE_NUM), -5, 3)!='-89') ~> FtrNonAdjustments",
                "select1 split(SOURCE_TYPE ==\"BHLFR\" && STATUS ==\"SHIPPED\",",
                "     SOURCE_TYPE ==\"BH-PLATES\" && STATUS ==\"SHIPPED\",",
                "     SOURCE_TYPE ==\"EASTERN PLATES\" && STATUS ==\"SHIPPED\",",
                "     disjoint: false) ~> split1@(BHLFRNew, BHPlatesNew, EPNew, Defaault)",
                "FtrNonAdjustments select(mapColumn(",
                "          ACD,",
                "          INVOICE_NUM,",
                "          MATERIAL_ID,",
                "          INVOICE_CC_INVOICE_YEAR,",
                "          INVOICE_MONTH,",
                "          INVOICE_DAY,",
                "          PACK_BOL_NUM,",
                "          PACK_SLIP_NUM,",
                "          SHIPPED_CC_SHIPPED_YEAR,",
                "          SHIPPED_MONTH,",
                "          SHIPPED_DAY,",
                "          SHIP_MO,",
                "          SHIP_DAY,",
                "          SHIP_YEAR,",
                "          SHIPPED_TIME,",
                "          MS_INTERPLANT,",
                "          METH_OF_SHIP,",
                "          SCAC_CODE,",
                "          SCAC_DESCR,",
                "          ROUTE_CODE,",
                "          ROUTE_DESCR,",
                "          VEHICLE_ID,",
                "          P_C_IND,",
                "          PREPAID_COLLECT,",
                "          MILEAGE,",
                "          DISTANCE_UOM,",
                "          TOTAL_SHIP_WEIGHT,",
                "          UOM_WEIGHT,",
                "          MIN_WEIGHT,",
                "          MIN_WEIGHT_UOM,",
                "          TOTAL_FRT_COST,",
                "          FRT_RATE,",
                "          FRT_UOM,",
                "          ADDTNL_FRT_COST,",
                "          ADDTNL_FRT_RATE,",
                "          ADDTNL_FRT_UOM,",
                "          FRT_COST_SC,",
                "          FRT_SC_RATE,",
                "          FRT_SC_UOM,",
                "          CUST_CODE,",
                "          BILL_TO_CUSTOMER,",
                "          ORIG_CUST_CODE,",
                "          SHIP_FROM_DESCR,",
                "          SHIP_FROM_STATE,",
                "          SHIP_FROM_CITY,",
                "          SHIP_FROM_ZIP_CODE,",
                "          SHIP_FROM_COUNTRY,",
                "          DEST_CUST_CODE,",
                "          SHIP_TO_CUSTOMER,",
                "          SHIP_TO_STATE,",
                "          SHIP_TO_CITY,",
                "          SHIP_TO_ZIP_CODE,",
                "          SHIP_TO_COUNTRY,",
                "          DATA_SOURCE,",
                "          COMPETITIVE_IND,",
                "          CONTRACT_RATE,",
                "          MILL_ORDER_SPLIT_NO1,",
                "          MS_ORDER_MILL_SPLIT_NO2,",
                "          FACILITY_CODE,",
                "          STCC_CODE_OUT,",
                "          THICKNESS_MAX,",
                "          THICKNESS_UOM,",
                "          WIDTH_MAX,",
                "          WIDTH_UOM,",
                "          LENGTH_MAX,",
                "          LENGTH_UOM,",
                "          PART_NUMBER,",
                "          PART_NUMBER_DESC,",
                "          COMMODITY_DESCR,",
                "          ITEM_FRT_COST,",
                "          MATL_ID_WEIGHT,",
                "          MATL_ID_LAST_COIL,",
                "          MATL_ID_PRO_AMT,",
                "          MATL_ID_SC_AMT,",
                "          CUST_FRT,",
                "          POSTING_PERIOD,",
                "          ITEM_SHIPPED_PIECES,",
                "          PROCESSOR_MATL_ID,",
                "          OUT_TM_AVAIL_TO_SHIP_DATE,",
                "          OUT_TM_LOAD_READY_DATE,",
                "          OUT_TM_DATE_SCHD_PICKUP,",
                "          OUT_TM_PLN_CARRIER_PICKUP_DTE,",
                "          OUT_PLANNED_TRANS_MODE,",
                "          OUT_PLANNED_FRT_TYPE_CODE,",
                "          OUT_PLANNED_NEXT_SHIP_DATE,",
                "          OUT_HEAT_NBR,",
                "          ACCT_PROD_CODE,",
                "          BETH_SOURCE_CODE,",
                "          LINEAL_FT_ENG,",
                "          LINEAL_FT_MET,",
                "          THEO_WGT_LB,",
                "          THEO_WGT_KG,",
                "          TIME_ZONE,",
                "          SAP_ORDER_NUM,",
                "          STATUS,",
                "          ACTION,",
                "          BOL_NUMBER,",
                "          SHIPMENT_DATE,",
                "          SOURCE_TYPE,",
                "          {_c95}",
                "     ),",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true) ~> select1",
                "SrcBeth split(left(PACK_BOL_NUM,4)!='084L'&&left(PACK_BOL_NUM,4)!='086L'\r",
                "&& upper(trim(P_C_IND)) == 'P' && toString(round(toDecimal(ITEM_FRT_COST),2)) != '0.00' && trim(ITEM_FRT_COST) != '',",
                "     disjoint: false) ~> SplitBasedOnBol@(ValidBols, InvalidBols)",
                "splitFiles@BHlfrAdjustmentsNew sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     format: 'parquet',",
                "     partitionFileNames:[($FileName_BHLFRAdjustmentsNew)],",
                "     umask: 0022,",
                "     preCommands: [],",
                "     postCommands: [],",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     mapColumn(",
                "          ACD,",
                "          INVOICE_NUM,",
                "          MATERIAL_ID,",
                "          INVOICE_CC_INVOICE_YEAR,",
                "          INVOICE_MONTH,",
                "          INVOICE_DAY,",
                "          PACK_BOL_NUM,",
                "          PACK_SLIP_NUM,",
                "          SHIPPED_CC_SHIPPED_YEAR,",
                "          SHIPPED_MONTH,",
                "          SHIPPED_DAY,",
                "          SHIP_MO,",
                "          SHIP_DAY,",
                "          SHIP_YEAR,",
                "          SHIPPED_TIME,",
                "          MS_INTERPLANT,",
                "          METH_OF_SHIP,",
                "          SCAC_CODE,",
                "          SCAC_DESCR,",
                "          ROUTE_CODE,",
                "          ROUTE_DESCR,",
                "          VEHICLE_ID,",
                "          P_C_IND,",
                "          PREPAID_COLLECT,",
                "          MILEAGE,",
                "          DISTANCE_UOM,",
                "          TOTAL_SHIP_WEIGHT,",
                "          UOM_WEIGHT,",
                "          MIN_WEIGHT,",
                "          MIN_WEIGHT_UOM,",
                "          TOTAL_FRT_COST,",
                "          FRT_RATE,",
                "          FRT_UOM,",
                "          ADDTNL_FRT_COST,",
                "          ADDTNL_FRT_RATE,",
                "          ADDTNL_FRT_UOM,",
                "          FRT_COST_SC,",
                "          FRT_SC_RATE,",
                "          FRT_SC_UOM,",
                "          CUST_CODE,",
                "          BILL_TO_CUSTOMER,",
                "          ORIG_CUST_CODE,",
                "          SHIP_FROM_DESCR,",
                "          SHIP_FROM_STATE,",
                "          SHIP_FROM_CITY,",
                "          SHIP_FROM_ZIP_CODE,",
                "          SHIP_FROM_COUNTRY,",
                "          DEST_CUST_CODE,",
                "          SHIP_TO_CUSTOMER,",
                "          SHIP_TO_STATE,",
                "          SHIP_TO_CITY,",
                "          SHIP_TO_ZIP_CODE,",
                "          SHIP_TO_COUNTRY,",
                "          DATA_SOURCE,",
                "          COMPETITIVE_IND,",
                "          CONTRACT_RATE,",
                "          MILL_ORDER_SPLIT_NO1,",
                "          MS_ORDER_MILL_SPLIT_NO2,",
                "          FACILITY_CODE,",
                "          STCC_CODE_OUT,",
                "          THICKNESS_MAX,",
                "          THICKNESS_UOM,",
                "          WIDTH_MAX,",
                "          WIDTH_UOM,",
                "          LENGTH_MAX,",
                "          LENGTH_UOM,",
                "          PART_NUMBER,",
                "          PART_NUMBER_DESC,",
                "          COMMODITY_DESCR,",
                "          ITEM_FRT_COST,",
                "          MATL_ID_WEIGHT,",
                "          MATL_ID_LAST_COIL,",
                "          MATL_ID_PRO_AMT,",
                "          MATL_ID_SC_AMT,",
                "          CUST_FRT,",
                "          POSTING_PERIOD,",
                "          ITEM_SHIPPED_PIECES,",
                "          PROCESSOR_MATL_ID,",
                "          OUT_TM_AVAIL_TO_SHIP_DATE,",
                "          OUT_TM_LOAD_READY_DATE,",
                "          OUT_TM_DATE_SCHD_PICKUP,",
                "          OUT_TM_PLN_CARRIER_PICKUP_DTE,",
                "          OUT_PLANNED_TRANS_MODE,",
                "          OUT_PLANNED_FRT_TYPE_CODE,",
                "          OUT_PLANNED_NEXT_SHIP_DATE,",
                "          OUT_HEAT_NBR,",
                "          ACCT_PROD_CODE,",
                "          STATUS,",
                "          ACTION,",
                "          BOL_NUMBER,",
                "          SHIPMENT_DATE,",
                "          SOURCE_TYPE,",
                "          BETH_SOURCE_CODE",
                "     ),",
                "     partitionBy('hash', 1)) ~> SnkBhlfrAdjustmentsNew",
                "splitFiles@BHlfrCancel sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     format: 'parquet',",
                "     partitionFileNames:[($FileName_BHLFRCancel)],",
                "     umask: 0022,",
                "     preCommands: [],",
                "     postCommands: [],",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     mapColumn(",
                "          ACD,",
                "          INVOICE_NUM,",
                "          MATERIAL_ID,",
                "          INVOICE_CC_INVOICE_YEAR,",
                "          INVOICE_MONTH,",
                "          INVOICE_DAY,",
                "          PACK_BOL_NUM,",
                "          PACK_SLIP_NUM,",
                "          SHIPPED_CC_SHIPPED_YEAR,",
                "          SHIPPED_MONTH,",
                "          SHIPPED_DAY,",
                "          SHIP_MO,",
                "          SHIP_DAY,",
                "          SHIP_YEAR,",
                "          SHIPPED_TIME,",
                "          MS_INTERPLANT,",
                "          METH_OF_SHIP,",
                "          SCAC_CODE,",
                "          SCAC_DESCR,",
                "          ROUTE_CODE,",
                "          ROUTE_DESCR,",
                "          VEHICLE_ID,",
                "          P_C_IND,",
                "          PREPAID_COLLECT,",
                "          MILEAGE,",
                "          DISTANCE_UOM,",
                "          TOTAL_SHIP_WEIGHT,",
                "          UOM_WEIGHT,",
                "          MIN_WEIGHT,",
                "          MIN_WEIGHT_UOM,",
                "          TOTAL_FRT_COST,",
                "          FRT_RATE,",
                "          FRT_UOM,",
                "          ADDTNL_FRT_COST,",
                "          ADDTNL_FRT_RATE,",
                "          ADDTNL_FRT_UOM,",
                "          FRT_COST_SC,",
                "          FRT_SC_RATE,",
                "          FRT_SC_UOM,",
                "          CUST_CODE,",
                "          BILL_TO_CUSTOMER,",
                "          ORIG_CUST_CODE,",
                "          SHIP_FROM_DESCR,",
                "          SHIP_FROM_STATE,",
                "          SHIP_FROM_CITY,",
                "          SHIP_FROM_ZIP_CODE,",
                "          SHIP_FROM_COUNTRY,",
                "          DEST_CUST_CODE,",
                "          SHIP_TO_CUSTOMER,",
                "          SHIP_TO_STATE,",
                "          SHIP_TO_CITY,",
                "          SHIP_TO_ZIP_CODE,",
                "          SHIP_TO_COUNTRY,",
                "          DATA_SOURCE,",
                "          COMPETITIVE_IND,",
                "          CONTRACT_RATE,",
                "          MILL_ORDER_SPLIT_NO1,",
                "          MS_ORDER_MILL_SPLIT_NO2,",
                "          FACILITY_CODE,",
                "          STCC_CODE_OUT,",
                "          THICKNESS_MAX,",
                "          THICKNESS_UOM,",
                "          WIDTH_MAX,",
                "          WIDTH_UOM,",
                "          LENGTH_MAX,",
                "          LENGTH_UOM,",
                "          PART_NUMBER,",
                "          PART_NUMBER_DESC,",
                "          COMMODITY_DESCR,",
                "          ITEM_FRT_COST,",
                "          MATL_ID_WEIGHT,",
                "          MATL_ID_LAST_COIL,",
                "          MATL_ID_PRO_AMT,",
                "          MATL_ID_SC_AMT,",
                "          CUST_FRT,",
                "          POSTING_PERIOD,",
                "          ITEM_SHIPPED_PIECES,",
                "          PROCESSOR_MATL_ID,",
                "          OUT_TM_AVAIL_TO_SHIP_DATE,",
                "          OUT_TM_LOAD_READY_DATE,",
                "          OUT_TM_DATE_SCHD_PICKUP,",
                "          OUT_TM_PLN_CARRIER_PICKUP_DTE,",
                "          OUT_PLANNED_TRANS_MODE,",
                "          OUT_PLANNED_FRT_TYPE_CODE,",
                "          OUT_PLANNED_NEXT_SHIP_DATE,",
                "          OUT_HEAT_NBR,",
                "          ACCT_PROD_CODE,",
                "          STATUS,",
                "          ACTION,",
                "          BOL_NUMBER,",
                "          SHIPMENT_DATE,",
                "          SOURCE_TYPE,",
                "          BETH_SOURCE_CODE",
                "     ),",
                "     partitionBy('hash', 1)) ~> SnkBhlfrCancel",
                "splitFiles@BHPlatesCancel sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     format: 'parquet',",
                "     partitionFileNames:[($FileName_BHPlatesCancel)],",
                "     umask: 0022,",
                "     preCommands: [],",
                "     postCommands: [],",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     mapColumn(",
                "          ACD,",
                "          INVOICE_NUM,",
                "          MATERIAL_ID,",
                "          INVOICE_CC_INVOICE_YEAR,",
                "          INVOICE_MONTH,",
                "          INVOICE_DAY,",
                "          PACK_BOL_NUM,",
                "          PACK_SLIP_NUM,",
                "          SHIPPED_CC_SHIPPED_YEAR,",
                "          SHIPPED_MONTH,",
                "          SHIPPED_DAY,",
                "          SHIP_MO,",
                "          SHIP_DAY,",
                "          SHIP_YEAR,",
                "          SHIPPED_TIME,",
                "          MS_INTERPLANT,",
                "          METH_OF_SHIP,",
                "          SCAC_CODE,",
                "          SCAC_DESCR,",
                "          ROUTE_CODE,",
                "          ROUTE_DESCR,",
                "          VEHICLE_ID,",
                "          P_C_IND,",
                "          PREPAID_COLLECT,",
                "          MILEAGE,",
                "          DISTANCE_UOM,",
                "          TOTAL_SHIP_WEIGHT,",
                "          UOM_WEIGHT,",
                "          MIN_WEIGHT,",
                "          MIN_WEIGHT_UOM,",
                "          TOTAL_FRT_COST,",
                "          FRT_RATE,",
                "          FRT_UOM,",
                "          ADDTNL_FRT_COST,",
                "          ADDTNL_FRT_RATE,",
                "          ADDTNL_FRT_UOM,",
                "          FRT_COST_SC,",
                "          FRT_SC_RATE,",
                "          FRT_SC_UOM,",
                "          CUST_CODE,",
                "          BILL_TO_CUSTOMER,",
                "          ORIG_CUST_CODE,",
                "          SHIP_FROM_DESCR,",
                "          SHIP_FROM_STATE,",
                "          SHIP_FROM_CITY,",
                "          SHIP_FROM_ZIP_CODE,",
                "          SHIP_FROM_COUNTRY,",
                "          DEST_CUST_CODE,",
                "          SHIP_TO_CUSTOMER,",
                "          SHIP_TO_STATE,",
                "          SHIP_TO_CITY,",
                "          SHIP_TO_ZIP_CODE,",
                "          SHIP_TO_COUNTRY,",
                "          DATA_SOURCE,",
                "          COMPETITIVE_IND,",
                "          CONTRACT_RATE,",
                "          MILL_ORDER_SPLIT_NO1,",
                "          MS_ORDER_MILL_SPLIT_NO2,",
                "          FACILITY_CODE,",
                "          STCC_CODE_OUT,",
                "          THICKNESS_MAX,",
                "          THICKNESS_UOM,",
                "          WIDTH_MAX,",
                "          WIDTH_UOM,",
                "          LENGTH_MAX,",
                "          LENGTH_UOM,",
                "          PART_NUMBER,",
                "          PART_NUMBER_DESC,",
                "          COMMODITY_DESCR,",
                "          ITEM_FRT_COST,",
                "          MATL_ID_WEIGHT,",
                "          MATL_ID_LAST_COIL,",
                "          MATL_ID_PRO_AMT,",
                "          MATL_ID_SC_AMT,",
                "          CUST_FRT,",
                "          POSTING_PERIOD,",
                "          ITEM_SHIPPED_PIECES,",
                "          PROCESSOR_MATL_ID,",
                "          OUT_TM_AVAIL_TO_SHIP_DATE,",
                "          OUT_TM_LOAD_READY_DATE,",
                "          OUT_TM_DATE_SCHD_PICKUP,",
                "          OUT_TM_PLN_CARRIER_PICKUP_DTE,",
                "          OUT_PLANNED_TRANS_MODE,",
                "          OUT_PLANNED_FRT_TYPE_CODE,",
                "          OUT_PLANNED_NEXT_SHIP_DATE,",
                "          OUT_HEAT_NBR,",
                "          ACCT_PROD_CODE,",
                "          STATUS,",
                "          ACTION,",
                "          BOL_NUMBER,",
                "          SHIPMENT_DATE,",
                "          SOURCE_TYPE,",
                "          BETH_SOURCE_CODE",
                "     ),",
                "     partitionBy('hash', 1)) ~> SnkBhplatesCancel",
                "splitFiles@BHPlatesAdjustmentsNew sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     format: 'parquet',",
                "     partitionFileNames:[($FileName_BHPlatesAdjustmentsNew)],",
                "     umask: 0022,",
                "     preCommands: [],",
                "     postCommands: [],",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     mapColumn(",
                "          ACD,",
                "          INVOICE_NUM,",
                "          MATERIAL_ID,",
                "          INVOICE_CC_INVOICE_YEAR,",
                "          INVOICE_MONTH,",
                "          INVOICE_DAY,",
                "          PACK_BOL_NUM,",
                "          PACK_SLIP_NUM,",
                "          SHIPPED_CC_SHIPPED_YEAR,",
                "          SHIPPED_MONTH,",
                "          SHIPPED_DAY,",
                "          SHIP_MO,",
                "          SHIP_DAY,",
                "          SHIP_YEAR,",
                "          SHIPPED_TIME,",
                "          MS_INTERPLANT,",
                "          METH_OF_SHIP,",
                "          SCAC_CODE,",
                "          SCAC_DESCR,",
                "          ROUTE_CODE,",
                "          ROUTE_DESCR,",
                "          VEHICLE_ID,",
                "          P_C_IND,",
                "          PREPAID_COLLECT,",
                "          MILEAGE,",
                "          DISTANCE_UOM,",
                "          TOTAL_SHIP_WEIGHT,",
                "          UOM_WEIGHT,",
                "          MIN_WEIGHT,",
                "          MIN_WEIGHT_UOM,",
                "          TOTAL_FRT_COST,",
                "          FRT_RATE,",
                "          FRT_UOM,",
                "          ADDTNL_FRT_COST,",
                "          ADDTNL_FRT_RATE,",
                "          ADDTNL_FRT_UOM,",
                "          FRT_COST_SC,",
                "          FRT_SC_RATE,",
                "          FRT_SC_UOM,",
                "          CUST_CODE,",
                "          BILL_TO_CUSTOMER,",
                "          ORIG_CUST_CODE,",
                "          SHIP_FROM_DESCR,",
                "          SHIP_FROM_STATE,",
                "          SHIP_FROM_CITY,",
                "          SHIP_FROM_ZIP_CODE,",
                "          SHIP_FROM_COUNTRY,",
                "          DEST_CUST_CODE,",
                "          SHIP_TO_CUSTOMER,",
                "          SHIP_TO_STATE,",
                "          SHIP_TO_CITY,",
                "          SHIP_TO_ZIP_CODE,",
                "          SHIP_TO_COUNTRY,",
                "          DATA_SOURCE,",
                "          COMPETITIVE_IND,",
                "          CONTRACT_RATE,",
                "          MILL_ORDER_SPLIT_NO1,",
                "          MS_ORDER_MILL_SPLIT_NO2,",
                "          FACILITY_CODE,",
                "          STCC_CODE_OUT,",
                "          THICKNESS_MAX,",
                "          THICKNESS_UOM,",
                "          WIDTH_MAX,",
                "          WIDTH_UOM,",
                "          LENGTH_MAX,",
                "          LENGTH_UOM,",
                "          PART_NUMBER,",
                "          PART_NUMBER_DESC,",
                "          COMMODITY_DESCR,",
                "          ITEM_FRT_COST,",
                "          MATL_ID_WEIGHT,",
                "          MATL_ID_LAST_COIL,",
                "          MATL_ID_PRO_AMT,",
                "          MATL_ID_SC_AMT,",
                "          CUST_FRT,",
                "          POSTING_PERIOD,",
                "          ITEM_SHIPPED_PIECES,",
                "          PROCESSOR_MATL_ID,",
                "          OUT_TM_AVAIL_TO_SHIP_DATE,",
                "          OUT_TM_LOAD_READY_DATE,",
                "          OUT_TM_DATE_SCHD_PICKUP,",
                "          OUT_TM_PLN_CARRIER_PICKUP_DTE,",
                "          OUT_PLANNED_TRANS_MODE,",
                "          OUT_PLANNED_FRT_TYPE_CODE,",
                "          OUT_PLANNED_NEXT_SHIP_DATE,",
                "          OUT_HEAT_NBR,",
                "          ACCT_PROD_CODE,",
                "          STATUS,",
                "          ACTION,",
                "          BOL_NUMBER,",
                "          SHIPMENT_DATE,",
                "          SOURCE_TYPE,",
                "          BETH_SOURCE_CODE",
                "     ),",
                "     partitionBy('hash', 1)) ~> SnkBhplatesAdjustmentsNew",
                "splitFiles@EPAdjustmentsNew sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     format: 'parquet',",
                "     partitionFileNames:[($FileName_EasternPlatesAdjustmentsNew)],",
                "     umask: 0022,",
                "     preCommands: [],",
                "     postCommands: [],",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     mapColumn(",
                "          ACD,",
                "          INVOICE_NUM,",
                "          MATERIAL_ID,",
                "          INVOICE_CC_INVOICE_YEAR,",
                "          INVOICE_MONTH,",
                "          INVOICE_DAY,",
                "          PACK_BOL_NUM,",
                "          PACK_SLIP_NUM,",
                "          SHIPPED_CC_SHIPPED_YEAR,",
                "          SHIPPED_MONTH,",
                "          SHIPPED_DAY,",
                "          SHIP_MO,",
                "          SHIP_DAY,",
                "          SHIP_YEAR,",
                "          SHIPPED_TIME,",
                "          MS_INTERPLANT,",
                "          METH_OF_SHIP,",
                "          SCAC_CODE,",
                "          SCAC_DESCR,",
                "          ROUTE_CODE,",
                "          ROUTE_DESCR,",
                "          VEHICLE_ID,",
                "          P_C_IND,",
                "          PREPAID_COLLECT,",
                "          MILEAGE,",
                "          DISTANCE_UOM,",
                "          TOTAL_SHIP_WEIGHT,",
                "          UOM_WEIGHT,",
                "          MIN_WEIGHT,",
                "          MIN_WEIGHT_UOM,",
                "          TOTAL_FRT_COST,",
                "          FRT_RATE,",
                "          FRT_UOM,",
                "          ADDTNL_FRT_COST,",
                "          ADDTNL_FRT_RATE,",
                "          ADDTNL_FRT_UOM,",
                "          FRT_COST_SC,",
                "          FRT_SC_RATE,",
                "          FRT_SC_UOM,",
                "          CUST_CODE,",
                "          BILL_TO_CUSTOMER,",
                "          ORIG_CUST_CODE,",
                "          SHIP_FROM_DESCR,",
                "          SHIP_FROM_STATE,",
                "          SHIP_FROM_CITY,",
                "          SHIP_FROM_ZIP_CODE,",
                "          SHIP_FROM_COUNTRY,",
                "          DEST_CUST_CODE,",
                "          SHIP_TO_CUSTOMER,",
                "          SHIP_TO_STATE,",
                "          SHIP_TO_CITY,",
                "          SHIP_TO_ZIP_CODE,",
                "          SHIP_TO_COUNTRY,",
                "          DATA_SOURCE,",
                "          COMPETITIVE_IND,",
                "          CONTRACT_RATE,",
                "          MILL_ORDER_SPLIT_NO1,",
                "          MS_ORDER_MILL_SPLIT_NO2,",
                "          FACILITY_CODE,",
                "          STCC_CODE_OUT,",
                "          THICKNESS_MAX,",
                "          THICKNESS_UOM,",
                "          WIDTH_MAX,",
                "          WIDTH_UOM,",
                "          LENGTH_MAX,",
                "          LENGTH_UOM,",
                "          PART_NUMBER,",
                "          PART_NUMBER_DESC,",
                "          COMMODITY_DESCR,",
                "          ITEM_FRT_COST,",
                "          MATL_ID_WEIGHT,",
                "          MATL_ID_LAST_COIL,",
                "          MATL_ID_PRO_AMT,",
                "          MATL_ID_SC_AMT,",
                "          CUST_FRT,",
                "          POSTING_PERIOD,",
                "          ITEM_SHIPPED_PIECES,",
                "          PROCESSOR_MATL_ID,",
                "          OUT_TM_AVAIL_TO_SHIP_DATE,",
                "          OUT_TM_LOAD_READY_DATE,",
                "          OUT_TM_DATE_SCHD_PICKUP,",
                "          OUT_TM_PLN_CARRIER_PICKUP_DTE,",
                "          OUT_PLANNED_TRANS_MODE,",
                "          OUT_PLANNED_FRT_TYPE_CODE,",
                "          OUT_PLANNED_NEXT_SHIP_DATE,",
                "          OUT_HEAT_NBR,",
                "          ACCT_PROD_CODE,",
                "          STATUS,",
                "          ACTION,",
                "          BOL_NUMBER,",
                "          SHIPMENT_DATE,",
                "          SOURCE_TYPE,",
                "          BETH_SOURCE_CODE",
                "     ),",
                "     partitionBy('hash', 1)) ~> SnkEpAdjustmentsNew",
                "splitFiles@EPCancel sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     format: 'parquet',",
                "     partitionFileNames:[($FileName_EasternPlatesCancel)],",
                "     umask: 0022,",
                "     preCommands: [],",
                "     postCommands: [],",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     mapColumn(",
                "          ACD,",
                "          INVOICE_NUM,",
                "          MATERIAL_ID,",
                "          INVOICE_CC_INVOICE_YEAR,",
                "          INVOICE_MONTH,",
                "          INVOICE_DAY,",
                "          PACK_BOL_NUM,",
                "          PACK_SLIP_NUM,",
                "          SHIPPED_CC_SHIPPED_YEAR,",
                "          SHIPPED_MONTH,",
                "          SHIPPED_DAY,",
                "          SHIP_MO,",
                "          SHIP_DAY,",
                "          SHIP_YEAR,",
                "          SHIPPED_TIME,",
                "          MS_INTERPLANT,",
                "          METH_OF_SHIP,",
                "          SCAC_CODE,",
                "          SCAC_DESCR,",
                "          ROUTE_CODE,",
                "          ROUTE_DESCR,",
                "          VEHICLE_ID,",
                "          P_C_IND,",
                "          PREPAID_COLLECT,",
                "          MILEAGE,",
                "          DISTANCE_UOM,",
                "          TOTAL_SHIP_WEIGHT,",
                "          UOM_WEIGHT,",
                "          MIN_WEIGHT,",
                "          MIN_WEIGHT_UOM,",
                "          TOTAL_FRT_COST,",
                "          FRT_RATE,",
                "          FRT_UOM,",
                "          ADDTNL_FRT_COST,",
                "          ADDTNL_FRT_RATE,",
                "          ADDTNL_FRT_UOM,",
                "          FRT_COST_SC,",
                "          FRT_SC_RATE,",
                "          FRT_SC_UOM,",
                "          CUST_CODE,",
                "          BILL_TO_CUSTOMER,",
                "          ORIG_CUST_CODE,",
                "          SHIP_FROM_DESCR,",
                "          SHIP_FROM_STATE,",
                "          SHIP_FROM_CITY,",
                "          SHIP_FROM_ZIP_CODE,",
                "          SHIP_FROM_COUNTRY,",
                "          DEST_CUST_CODE,",
                "          SHIP_TO_CUSTOMER,",
                "          SHIP_TO_STATE,",
                "          SHIP_TO_CITY,",
                "          SHIP_TO_ZIP_CODE,",
                "          SHIP_TO_COUNTRY,",
                "          DATA_SOURCE,",
                "          COMPETITIVE_IND,",
                "          CONTRACT_RATE,",
                "          MILL_ORDER_SPLIT_NO1,",
                "          MS_ORDER_MILL_SPLIT_NO2,",
                "          FACILITY_CODE,",
                "          STCC_CODE_OUT,",
                "          THICKNESS_MAX,",
                "          THICKNESS_UOM,",
                "          WIDTH_MAX,",
                "          WIDTH_UOM,",
                "          LENGTH_MAX,",
                "          LENGTH_UOM,",
                "          PART_NUMBER,",
                "          PART_NUMBER_DESC,",
                "          COMMODITY_DESCR,",
                "          ITEM_FRT_COST,",
                "          MATL_ID_WEIGHT,",
                "          MATL_ID_LAST_COIL,",
                "          MATL_ID_PRO_AMT,",
                "          MATL_ID_SC_AMT,",
                "          CUST_FRT,",
                "          POSTING_PERIOD,",
                "          ITEM_SHIPPED_PIECES,",
                "          PROCESSOR_MATL_ID,",
                "          OUT_TM_AVAIL_TO_SHIP_DATE,",
                "          OUT_TM_LOAD_READY_DATE,",
                "          OUT_TM_DATE_SCHD_PICKUP,",
                "          OUT_TM_PLN_CARRIER_PICKUP_DTE,",
                "          OUT_PLANNED_TRANS_MODE,",
                "          OUT_PLANNED_FRT_TYPE_CODE,",
                "          OUT_PLANNED_NEXT_SHIP_DATE,",
                "          OUT_HEAT_NBR,",
                "          ACCT_PROD_CODE,",
                "          STATUS,",
                "          ACTION,",
                "          BOL_NUMBER,",
                "          SHIPMENT_DATE,",
                "          SOURCE_TYPE,",
                "          BETH_SOURCE_CODE",
                "     ),",
                "     partitionBy('hash', 1)) ~> SnkEPCancel",
                "split1@BHLFRNew sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     format: 'parquet',",
                "     partitionFileNames:[($FileName_BHLFRNew)],",
                "     umask: 0022,",
                "     preCommands: [],",
                "     postCommands: [],",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     partitionBy('hash', 1)) ~> SnkBhlfrNew",
                "split1@BHPlatesNew sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     format: 'parquet',",
                "     partitionFileNames:[($FileName_BHPlatesNew)],",
                "     umask: 0022,",
                "     preCommands: [],",
                "     postCommands: [],",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     partitionBy('hash', 1)) ~> SnkBhplatesNew",
                "split1@EPNew sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     format: 'parquet',",
                "     partitionFileNames:[($FileName_EasternPlatesNew)],",
                "     umask: 0022,",
                "     preCommands: [],",
                "     postCommands: [],",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     partitionBy('hash', 1)) ~> SnkEpNew"
            ]
        }
    }
}